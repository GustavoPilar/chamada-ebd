import{h as re}from"./chunk-U4EO7VLT.js";import{B as Q,D as W,F as Z,H as ee,N as te,P as ie,U as M,g as H,h as y,j as Y,k as z,m as U,n as J,o as X,q as N,u as K}from"./chunk-SUHVQDRK.js";import{Aa as g,Fa as O,M as E,Pa as S,Q as v,Qa as D,U as j,V,Va as d,Wa as l,Xa as u,Ya as f,db as $,fb as G,gb as F,pc as R,qa as s,qc as k,sb as P,ub as q,va as p,zb as w}from"./chunk-NCFPMDGA.js";var ne={production:!1,api_hostname:"https://localhost:7145"};var C=ne.api_hostname;var h=class o{constructor(r,t){this.httpClient=r;this.spinner=t}async getEntities(r){return new Promise((t,e)=>{try{this.spinner.show();let i=`${C}/${r}`,n={"Content-Type":"application/json"};this.httpClient.get(i,{headers:n}).subscribe(a=>{a&&(this.spinner.hide(),t(a))})}catch(i){console.log(i),this.spinner.hide(),e(i)}})}async getEntityById(r,t){return new Promise((e,i)=>{try{this.spinner.show();let n=`${C}/${r}/${t}`,a={"Content-Type":"application/json"};this.httpClient.get(n,{headers:a}).subscribe(m=>{m&&(this.spinner.hide(),e(m))})}catch(n){console.log(n),this.spinner.hide(),i(n)}})}async putEntityById(r,t,e){return new Promise((i,n)=>{try{this.spinner.show();let a=`${C}/${r}/${t}`,m={"Content-Type":"application/json"};this.httpClient.put(a,e,{headers:m}).subscribe(I=>{I&&(this.spinner.hide(),i(I))})}catch(a){console.log(a),this.spinner.hide(),n(a)}})}async postEntity(r,t){return new Promise((e,i)=>{try{this.spinner.show();let n=`${C}/${r}`,a={"Content-Type":"application/json"};this.httpClient.post(n,t,{headers:a}).subscribe(m=>{m&&(this.spinner.hide(),e(m))})}catch(n){console.log(n),this.spinner.hide(),i(n)}})}async deleteEntities(r,t){return new Promise((e,i)=>{try{this.spinner.show();let n=t[0]-1,a=t.length==1?t[t.length-1]:t[t.length-1]+1,m=[n,a],I=`${C}/${r}/delete`,B=new R;m.forEach(b=>{B=B.append("ids",b)});let le={"Content-Type":"application/json"};this.httpClient.delete(I,{headers:le,params:B}).subscribe(b=>{b&&(this.spinner.hide(),e(b))},b=>{this.spinner.hide(),i(b)})}catch(n){console.log(n),this.spinner.hide(),i(n)}})}static \u0275fac=function(t){return new(t||o)(v(k),v(re))};static \u0275prov=E({token:o,factory:o.\u0275fac,providedIn:"root"})};var c=class o{constructor(r){this.apiService=r}entityName;entityId;initialize(r){this.entityName=r.entityName,this.entityId=r.entityId}getEntities(){return new Promise((r,t)=>{try{this.apiService.getEntities(this.entityName).then(e=>{e&&r(e)})}catch(e){console.log(e),t(e)}})}getEntityById(){return new Promise((r,t)=>{try{this.entityId>0?this.apiService.getEntityById(this.entityName,this.entityId).then(e=>{e&&r(e)}):r({id:0})}catch(e){console.log(e),t(e)}})}addEntity(r){return new Promise((t,e)=>{try{this.apiService.postEntity(this.entityName,r).then(i=>{i&&t(i)})}catch(i){console.log(i),e(i)}})}updateEntity(r){return new Promise((t,e)=>{try{this.apiService.putEntityById(this.entityName,this.entityId,r).then(i=>{i&&t(i)})}catch(i){console.log(i),e(i)}})}deleteEntities(r){return new Promise((t,e)=>{try{this.apiService.deleteEntities(this.entityName,r).then(i=>{i&&t(i)},i=>{e(i)})}catch(i){console.log(i),e(i)}})}static \u0275fac=function(t){return new(t||o)(v(h))};static \u0275prov=E({token:o,factory:o.\u0275fac,providedIn:"root"})};var A=class o{constructor(r,t,e,i){this.crudManager=r;this.apiService=t;this.formBuilder=e;this.dialogService=i}entityName;entityId;selectedEntity;entities;selectedEntities=[];isForm=!1;isList=!1;entityForm;currentDate=new Date;ngOnInit(){}ngAfterViewInit(){}initList(){return new Promise((r,t)=>{try{this.crudManager.initialize(this),this.crudManager.getEntities().then(e=>{e&&(this.entities=e,r(e))})}catch(e){console.log(e),t(e)}})}initForm(){return new Promise((r,t)=>{try{this.crudManager.initialize(this),this.loadResources().then(e=>{e&&this.crudManager.getEntityById().then(i=>{i&&(this.selectedEntity=i,this.entityForm=this.getForm(),r(i))})})}catch(e){console.log(e),t(e)}})}loadResources(){return Promise.all([])}canSave(){return this.entityForm?.valid??!1}getField(r){return this.entityForm.get(r)}getSpecialOptions(){return[]}prepareEntityToSave(){let r=this.entityForm.value;return r.id=this.selectedEntity.id,r}save(){return new Promise((r,t)=>{try{this.selectedEntity.id>0?this.crudManager.updateEntity(this.prepareEntityToSave()).then(e=>{e&&r(e)}):this.crudManager.addEntity(this.prepareEntityToSave()).then(e=>{e&&r(e)})}catch(e){console.log(e),t(e)}})}deleteEntities(){return new Promise((r,t)=>{try{this.crudManager.deleteEntities(this.selectedEntities.map(e=>e.id)).then(e=>{e&&(this.selectedEntities=[],this.crudManager.getEntities().then(i=>{i&&(this.entities=i,r(i))},i=>{t(i)}))},e=>{t(e)})}catch(e){console.log(e),t(e)}})}static \u0275fac=function(t){return new(t||o)(p(c),p(h),p(N),p(M))};static \u0275cmp=g({type:o,selectors:[["app-crud-base"]],standalone:!1,features:[w([c])],decls:0,vars:0,template:function(t,e){},encapsulation:2})};var _=class{single;plural;isFemale;constructor(r,t,e){this.single=r,this.plural=t,this.isFemale=e}};function me(o,r){o&1&&(l(0,"span",0),P(1,"*"),u())}var x=class o{description;abstractControl;constructor(){}isRequired(){return this.abstractControl?this.abstractControl.hasValidator(y.required):!1}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=g({type:o,selectors:[["app-label"]],inputs:{description:"description",abstractControl:"abstractControl"},standalone:!1,decls:4,vars:2,consts:[[2,"color","red"]],template:function(t,e){t&1&&(l(0,"label"),P(1),S(2,me,2,0,"span",0),P(3,` :
`),u()),t&2&&(s(),q(" ",e.description," "),s(),D(e.isRequired()?2:-1))},encapsulation:2})};function ue(o,r){if(o&1){let t=$();l(0,"form",0)(1,"div",1)(2,"div",2),f(3,"app-label",3),l(4,"p-iconField"),f(5,"input",4)(6,"p-inputIcon",5),u()(),l(7,"div",2),f(8,"app-label",6)(9,"p-toggleButton",7),u(),l(10,"div",2),f(11,"app-label",8),l(12,"p-datePicker",9),G("onSelect",function(i){j(t);let n=F();return V(n.onChangeBirthday(i))})("onClear",function(i){j(t);let n=F();return V(n.onChangeBirthday(i))}),u()(),l(13,"div",2),f(14,"app-label",10)(15,"p-inputNumber",11),u(),l(16,"div",2),f(17,"app-label",12)(18,"p-select",13),u()()()}if(o&2){let t=F();d("formGroup",t.entityForm),s(3),d("abstractControl",t.getField("name")),s(5),d("abstractControl",t.getField("status")),s(3),d("abstractControl",t.getField("birthday")),s(3),d("abstractControl",t.getField("age")),s(),d("min",0),s(2),d("abstractControl",t.getField("class")),s(),d("options",t.classes)}}var se=class o extends A{constructor(t,e,i,n){super(t,e,i,n);this.crudManager=t;this.apiService=e;this.formBuilder=i;this.dialogService=n}classes;ngOnInit(){super.ngOnInit()}getDisplayColumns(){return[{field:"name",label:"Nome",displayColumnType:0},{field:"age",label:"Idade",displayColumnType:1},{field:"birthday",label:"Data Nasc.",displayColumnType:3},{field:"status",label:"Ativo",displayColumnType:2},{field:"class.name",label:"Classe",displayColumnType:4}]}getTypeDescription(){return new _("Membro","Membros",!1)}getForm(){let t=new Date(this.selectedEntity?.birthday);return t.toString()=="Invalid Date"&&(t=new Date),console.log(this.selectedEntity),this.formBuilder.group({name:[this.selectedEntity?.name??null,y.required],age:[this.selectedEntity?.age??0,y.required],birthday:[t,y.required],status:[this.selectedEntity?.status??!0,y.required],class:[this.selectedEntity?.class??null,y.required]})}loadResources(){return Promise.all([this.loadClasses()])}onChangeBirthday(t){if(t==null){this.entityForm.get("age")?.setValue(0);return}let e=this.currentDate.getFullYear(),i=t.getFullYear(),n=e-i;this.entityForm.get("age")?.setValue(n)}loadClasses(){return new Promise((t,e)=>{try{this.apiService.getEntities("class").then(i=>{i&&(this.classes=i,t(i))})}catch(i){console.log(i),e(i)}})}static \u0275fac=function(e){return new(e||o)(p(c),p(h),p(N),p(M))};static \u0275cmp=g({type:o,selectors:[["app-Member"]],standalone:!1,features:[w([c]),O],decls:1,vars:1,consts:[[3,"formGroup"],[1,"grid"],[1,"field","col-12","md:col-6"],["description","Nome",3,"abstractControl"],["type","text","pInputText","","id","name","formControlName","name","fluid","","placeholder","Digite o nome"],[1,"pi","pi-user"],["description","Status",3,"abstractControl"],["id","status","formControlName","status","onLabel","Ativo","offLabel","Inativo","fluid",""],["description","Data de nascimento",3,"abstractControl"],["id","birthday","inputId","birthday","formControlName","birthday","dateFormat","dd/mm/yy","fluid","","showIcon","true","showClear","true","placeholder","Selecione a data de nascimento",3,"onSelect","onClear"],["description","Idade",3,"abstractControl"],["id","age","inputId","age","formControlName","age","fluid","","showButtons","true","showClear","false","placeholder","Digite a idade",3,"min"],["description","Classe",3,"abstractControl"],["optionLabel","name","optionValue","name","formControlName","class","fluid","",3,"options"]],template:function(e,i){e&1&&S(0,ue,19,8,"form",0),e&2&&D(i.isForm&&i.selectedEntity?0:-1)},dependencies:[U,H,Y,z,X,J,K,W,ie,ee,Z,te,Q,x],encapsulation:2})};export{se as MemberComponent};
