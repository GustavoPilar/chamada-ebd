import{h as te}from"./chunk-U4EO7VLT.js";import{I as U,M as K,O as X,P as Q,Q as Y,X as Z,Y as ee,i as C,j as H,k as W,l as q,m as J,n as z,o as k}from"./chunk-7TWCM24X.js";import{Aa as b,Ab as R,Ga as M,Lb as x,M as $,Pa as _,Q as E,Qa as v,Ra as A,Rb as L,Ta as F,U as I,Ua as V,V as B,Va as c,Wa as l,Xa as p,Ya as D,db as N,fb as P,gb as m,pc as O,qa as a,qc as j,sb as d,td as G,ub as f,va as h}from"./chunk-NCFPMDGA.js";var ie={production:!0,api_hostname:"https://chamada-ebd-b8hyd6fghfc6bvfm.brazilsouth-01.azurewebsites.net"};var y=ie.api_hostname;var w=class n{constructor(t,e){this.httpClient=t;this.spinner=e}getEntities(t){return new Promise((e,i)=>{try{this.spinner.show(),this.httpClient.get(`${y}/${t}`,{headers:{"Content-Type":"application/json"}}).subscribe({next:o=>{o&&(this.spinner.hide(),e(o))},error:o=>{this.spinner.hide(),i(o)}})}catch(o){console.log(o),this.spinner.hide(),i(o)}})}getEntityById(t,e){return new Promise((i,o)=>{try{this.spinner.show(),this.httpClient.get(`${y}/${t}/${e}`,{headers:{"Content-Type":"application/json"}}).subscribe({next:r=>{r&&(this.spinner.hide(),i(r))},error:r=>{this.spinner.hide(),o(r)}})}catch(r){console.log(r),this.spinner.hide(),o(r)}})}updateEntity(t,e,i){return new Promise((o,r)=>{try{this.spinner.show(),this.httpClient.put(`${y}/${t}/${e}`,i,{headers:{"Content-Type":"application/json"}}).subscribe({next:s=>{s&&(this.spinner.hide(),o(s))},error:s=>{this.spinner.hide(),r(s)}})}catch(s){console.log(s),this.spinner.hide(),r(s)}})}createEntity(t,e){return new Promise((i,o)=>{try{this.spinner.show(),this.httpClient.post(`${y}/${t}`,e,{headers:{"Content-Type":"application/json"}}).subscribe({next:r=>{r&&(this.spinner.hide(),i(r))},error:r=>{this.spinner.hide(),o(r)}})}catch(r){console.log(r),this.spinner.hide(),o(r)}})}async deleteEntities(t,e){return new Promise((i,o)=>{try{this.spinner.show();let r=e[0]-1,s=e.length==1?e[e.length-1]:e[e.length-1]+1,u=[r,s],T=new O;u.forEach(g=>{T=T.append("ids",g)}),this.httpClient.delete(`${y}/${t}/delete`,{headers:{"Content-Type":"application/json"},params:T}).subscribe({next:g=>{g&&(this.spinner.hide(),i(g))},error:g=>{this.spinner.hide(),o(g)}})}catch(r){console.log(r),this.spinner.hide(),o(r)}})}static \u0275fac=function(e){return new(e||n)(E(j),E(te))};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})};function le(n,t){n&1&&(l(0,"span",0),d(1,"*"),p())}var S=class n{description;abstractControl;constructor(){}isRequired(){return this.abstractControl?this.abstractControl.hasValidator(C.required):!1}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=b({type:n,selectors:[["app-label"]],inputs:{description:"description",abstractControl:"abstractControl"},standalone:!1,decls:4,vars:2,consts:[[2,"color","red"]],template:function(e,i){e&1&&(l(0,"label"),d(1),_(2,le,2,0,"span",0),d(3,` :
`),p()),e&2&&(a(),f(" ",i.description," "),a(),v(i.isRequired()?2:-1))},encapsulation:2})};var pe=()=>[10,20,50];function me(n,t){if(n&1&&(l(0,"th",13)(1,"div",14),d(2),D(3,"p-sortIcon",15),p()()),n&2){let e=t.$implicit;c("pSortableColumn",e.field),a(2),f(" ",e.label," "),a(),c("field",e.field)}}function ce(n,t){if(n&1&&(l(0,"tr"),F(1,me,4,3,"th",13,A),p()),n&2){let e=t.$implicit;a(),V(e)}}function de(n,t){if(n&1&&d(0),n&2){let e=m().$implicit,i=m().$implicit,o=m();f(" ",o.showDateValue(i[e.field])," ")}}function ue(n,t){if(n&1&&d(0),n&2){let e=m().$implicit,i=m().$implicit,o=m();f(" ",o.showObejctValue(i,e.field)," ")}}function he(n,t){if(n&1&&d(0),n&2){let e=m().$implicit,i=m().$implicit,o=m();f(" ",o.showDefaultValue(i[e.field])," ")}}function fe(n,t){if(n&1&&(l(0,"td"),_(1,de,1,1)(2,ue,1,1)(3,he,1,1),p()),n&2){let e=t.$implicit;a(),v(e.displayColumnType==3?1:e.displayColumnType==4?2:3)}}function ge(n,t){if(n&1&&(l(0,"tr"),F(1,fe,4,1,"td",null,A),p()),n&2){let e=t.columns;a(),V(e)}}function ye(n,t){if(n&1&&(l(0,"tr")(1,"td",16),d(2,"Nenhum registro foi encontrado"),p()()),n&2){let e=m();a(),c("colSpan",e.displayColumns.length)}}var oe=class n{constructor(t,e,i,o,r,s){this.config=t;this.viewRef=e;this.formBuilder=i;this.apiService=o;this.messageService=r;this.changeDetectorRef=s;this.entities=this.config.data.entities.filter(u=>u.birthday!=null).map(u=>u={name:u.name,birthday:new Date(u.birthday)})}entities;weedings;filteredValues;form;months;options=[{id:0,label:"Individual"},{id:1,label:"Casamento"}];alreadyLoad=!1;displayColumns;ngOnInit(){this.initNameMonths(),this.initForm(),this.getColumns(),this.filterEntities()}initNameMonths(){this.months=[{id:0,name:"Janeiro"},{id:1,name:"Fevereiro"},{id:2,name:"Mar\xE7o"},{id:3,name:"Abril"},{id:4,name:"Maio"},{id:5,name:"Junho"},{id:6,name:"Julho"},{id:7,name:"Agosto"},{id:8,name:"Setembro"},{id:9,name:"Outubro"},{id:10,name:"Novembro"},{id:11,name:"Dezembro"}]}initForm(){let t=this.months.findIndex(e=>e.id==new Date().getMonth());this.form=this.formBuilder.group({month:[this.months[t],C.required],type:[this.options[0],C.required]})}getField(t){return this.form.get(t)}filterEntities(){let t=this.form.get("month")?.value.id;this.filteredValues=this.entities.filter(e=>new Date(e.birthday).getMonth()==t)}filterWeedings(){let t=this.form.get("month")?.value.id;this.filteredValues=this.weedings.filter(e=>new Date(e.weedingDateTime).getMonth()==t)}transformDate(t){return t.toLocaleDateString()}onChangeType(t){this.filteredValues=[],t.value.id==0?(this.filterEntities(),this.changeDetectorRef.detectChanges()):this.alreadyLoad?(this.filterWeedings(),this.changeDetectorRef.detectChanges()):this.loadWeedings().then(e=>{e&&(this.alreadyLoad=!0,this.getColumns(),this.filterWeedings(),this.changeDetectorRef.detectChanges())},e=>{this.messageService.add({summary:"Erro ao carregar",detail:`Ocorreu um erro ao carregar os casamentos.
Tente novamente.`,life:3e3,closable:!0,severity:"error"}),this.form.get("type")?.setValue(this.options[0])})}loadWeedings(){return new Promise((t,e)=>{try{this.apiService.getEntities("weedingDate").then(i=>{i&&(this.weedings=i,t(i))},i=>{e(i)})}catch(i){console.log(i),e(i)}})}getColumns(){this.form.get("type")?.value.id==0?this.displayColumns=[{label:"Nome",field:"name",displayColumnType:0},{label:"Anivers\xE1rio",field:"birthday",displayColumnType:3}]:this.displayColumns=[{label:"Esposo",field:"husband.name",displayColumnType:4},{label:"Esposa",field:"wife.name",displayColumnType:4},{label:"Anivers\xE1rio",field:"weedingDateTime",displayColumnType:3}]}showObejctValue(t,e){let i=e.split("."),o=t;return i.forEach(r=>{o=o[r]}),o}showDefaultValue(t){return t}showDateValue(t){return new Date(t).toLocaleDateString()}onChangeMonth(){this.form.get("type")?.value.id==0?this.filterEntities():this.filterWeedings()}static \u0275fac=function(e){return new(e||n)(h(Z),h(ee),h(k),h(w),h(G),h(L))};static \u0275cmp=b({type:n,selectors:[["app-birthday-dialog"]],standalone:!1,decls:18,vars:11,consts:[["header",""],["body",""],["emptymessage",""],[1,"fluid","h-full"],[1,"w-full"],[3,"formGroup"],[1,"grid"],[1,"field","col-12","md:col-6"],["description","M\xEAs",3,"abstractControl"],["optionLabel","name","fluid","","placeholder","Selecione o m\xEAs do anivers\xE1rio","formControlName","month",3,"onChange","options"],["description","Tipo",3,"abstractControl"],["fluid","","formControlName","type",3,"onChange","options"],["dataKey","id","size","small","paginator","true","sortField","birthday","stripedRows","true",3,"value","columns","rows","rowsPerPageOptions","sortOrder"],[3,"pSortableColumn"],[1,"flex","justify-content-center","align-items-center","gap-2"],[3,"field"],[3,"colSpan"]],template:function(e,i){if(e&1){let o=N();l(0,"div",3)(1,"div",4)(2,"form",5)(3,"div",6)(4,"div",7),D(5,"app-label",8),l(6,"p-select",9),P("onChange",function(){return I(o),B(i.onChangeMonth())}),p()(),l(7,"div",7),D(8,"app-label",10),l(9,"p-selectButton",11),P("onChange",function(s){return I(o),B(i.onChangeType(s))}),p()()()()(),l(10,"div",4)(11,"p-table",12),M(12,ce,3,0,"ng-template",null,0,x)(14,ge,3,0,"ng-template",null,1,x)(16,ye,3,1,"ng-template",null,2,x),p()()()}e&2&&(a(2),c("formGroup",i.form),a(3),c("abstractControl",i.getField("month")),a(),c("options",i.months),a(2),c("abstractControl",i.getField("type")),a(),c("options",i.options),a(2),c("value",i.filteredValues)("columns",i.displayColumns)("rows",10)("rowsPerPageOptions",R(10,pe))("sortOrder",1))},dependencies:[X,Q,Y,q,H,W,z,J,K,U,S],encapsulation:2})};export{w as a,S as b,oe as c};
