import{a as z,b as K}from"./chunk-JE5ZA7TI.js";import{c as P,f as G,g as W,h as J}from"./chunk-73GDRVW2.js";import{N as L,R as k,S as q,h as T,j as R,k as A,m as N,n as O,o as $,q as j}from"./chunk-4QPRMCSV.js";import{Aa as w,Ab as F,Ga as S,Lb as g,Pa as E,Qa as B,Ra as _,Rb as V,Ta as b,U as y,Ua as v,V as C,Va as s,Wa as r,Xa as m,Ya as h,db as I,fb as D,gb as l,qa as a,sb as d,td as M,ub as u,va as p}from"./chunk-NCFPMDGA.js";var H=()=>[10,20,50];function Q(i,t){if(i&1&&(r(0,"th",13)(1,"div",14),d(2),h(3,"p-sortIcon",15),m()()),i&2){let e=t.$implicit;s("pSortableColumn",e.field),a(2),u(" ",e.label," "),a(),s("field",e.field)}}function U(i,t){if(i&1&&(r(0,"tr"),b(1,Q,4,3,"th",13,_),m()),i&2){let e=t.$implicit;a(),v(e)}}function Y(i,t){if(i&1&&d(0),i&2){let e=l().$implicit,n=l().$implicit,o=l();u(" ",o.showDateValue(n[e.field])," ")}}function Z(i,t){if(i&1&&d(0),i&2){let e=l().$implicit,n=l().$implicit,o=l();u(" ",o.showObejctValue(n,e.field)," ")}}function ee(i,t){if(i&1&&d(0),i&2){let e=l().$implicit,n=l().$implicit,o=l();u(" ",o.showDefaultValue(n[e.field])," ")}}function te(i,t){if(i&1&&(r(0,"td"),E(1,Y,1,1)(2,Z,1,1)(3,ee,1,1),m()),i&2){let e=t.$implicit;a(),B(e.displayColumnType==3?1:e.displayColumnType==4?2:3)}}function ie(i,t){if(i&1&&(r(0,"tr"),b(1,te,4,1,"td",null,_),m()),i&2){let e=t.columns;a(),v(e)}}function ne(i,t){if(i&1&&(r(0,"tr")(1,"td",16),d(2,"Nenhum registro foi encontrado"),m()()),i&2){let e=l();a(),s("colSpan",e.displayColumns.length)}}var X=class i{constructor(t,e,n,o,f,x){this.config=t;this.viewRef=e;this.formBuilder=n;this.apiService=o;this.messageService=f;this.changeDetectorRef=x;this.entities=this.config.data.entities.filter(c=>c.birthday!=null).map(c=>c={name:c.name,birthday:new Date(c.birthday)})}entities;weedings;filteredValues;form;months;options=[{id:0,label:"Individual"},{id:1,label:"Casamento"}];selectedType=this.options[0];alreadyLoad=!1;displayColumns;ngOnInit(){this.initNameMonths(),this.initForm(),this.getColumns(),this.filterEntities()}initNameMonths(){this.months=[{id:0,name:"Janeiro"},{id:1,name:"Fevereiro"},{id:2,name:"Mar\xE7o"},{id:3,name:"Abril"},{id:4,name:"Maio"},{id:5,name:"Junho"},{id:6,name:"Julho"},{id:7,name:"Agosto"},{id:8,name:"Setembro"},{id:9,name:"Outubro"},{id:10,name:"Novembro"},{id:11,name:"Dezembro"}]}initForm(){let t=this.months.findIndex(e=>e.id==new Date().getMonth());this.form=this.formBuilder.group({month:[this.months[t],T.required],isIndividual:[!0,T.required]})}getField(t){return this.form.get(t)}filterEntities(){let t=this.form.get("month")?.value.id;this.filteredValues=this.entities.filter(e=>new Date(e.birthday).getMonth()==t)}filterWeedings(){let t=this.form.get("month")?.value.id;this.filteredValues=this.weedings.filter(e=>new Date(e.weedingDateTime).getMonth()==t)}onChangeMonth(){this.selectedType.id==0?this.filterEntities():this.filterWeedings()}onChangeType(t){this.filteredValues=[],t.checked?(this.selectedType=this.options[0],this.getColumns(),this.filterEntities(),this.changeDetectorRef.detectChanges()):(this.selectedType=this.options[1],this.getColumns(),this.alreadyLoad?(this.filterWeedings(),this.changeDetectorRef.detectChanges()):this.loadWeedings().then(e=>{e&&(this.alreadyLoad=!0,this.filterWeedings(),this.changeDetectorRef.detectChanges())},e=>{this.messageService.add({summary:"Erro ao carregar",detail:`Ocorreu um erro ao carregar os casamentos.
Tente novamente.`,life:3e3,closable:!0,severity:"error"}),this.form.get("type")?.setValue(this.options[0]),this.filterEntities()}))}getColumns(){this.selectedType.id==0?this.displayColumns=[{label:"Nome",field:"name",displayColumnType:0},{label:"Anivers\xE1rio",field:"birthday",displayColumnType:3}]:this.displayColumns=[{label:"Esposo",field:"husband.name",displayColumnType:4},{label:"Esposa",field:"wife.name",displayColumnType:4},{label:"Anivers\xE1rio",field:"weedingDateTime",displayColumnType:3}]}showObejctValue(t,e){let n=e.split("."),o=t;return n.forEach(f=>{o=o[f]}),o}showDefaultValue(t){return t}showDateValue(t){return new Date(t).toLocaleDateString("pt-BR")}loadWeedings(){return new Promise((t,e)=>{try{this.apiService.getEntities("weedingDate").then(n=>{n&&(this.weedings=n,t(n))},n=>{e(n)})}catch(n){console.log(n),e(n)}})}static \u0275fac=function(e){return new(e||i)(p(k),p(q),p(j),p(z),p(M),p(V))};static \u0275cmp=w({type:i,selectors:[["app-birthday-dialog"]],standalone:!1,decls:18,vars:10,consts:[["header",""],["body",""],["emptymessage",""],[1,"fluid","h-full"],[1,"w-full"],[3,"formGroup"],[1,"grid"],[1,"field","col-12","md:col-6"],["description","M\xEAs",3,"abstractControl"],["optionLabel","name","fluid","","placeholder","Selecione o m\xEAs do anivers\xE1rio","formControlName","month",3,"onChange","options"],["description","Tipo",3,"abstractControl"],["fluid","","onLabel","Individual","offLabel","Casamento","formControlName","isIndividual",3,"onChange"],["dataKey","id","size","small","paginator","true","sortField","weedingDateTime","stripedRows","true",3,"value","columns","rows","rowsPerPageOptions","sortOrder"],[3,"pSortableColumn"],[1,"flex","justify-content-center","align-items-center","gap-2"],[3,"field"],[3,"colSpan"]],template:function(e,n){if(e&1){let o=I();r(0,"div",3)(1,"div",4)(2,"form",5)(3,"div",6)(4,"div",7),h(5,"app-label",8),r(6,"p-select",9),D("onChange",function(){return y(o),C(n.onChangeMonth())}),m()(),r(7,"div",7),h(8,"app-label",10),r(9,"p-toggleButton",11),D("onChange",function(x){return y(o),C(n.onChangeType(x))}),m()()()()(),r(10,"div",4)(11,"p-table",12),S(12,U,3,0,"ng-template",null,0,g)(14,ie,3,0,"ng-template",null,1,g)(16,ne,3,1,"ng-template",null,2,g),m()()()}e&2&&(a(2),s("formGroup",n.form),a(3),s("abstractControl",n.getField("month")),a(),s("options",n.months),a(2),s("abstractControl",n.getField("type")),a(3),s("value",n.filteredValues)("columns",n.displayColumns)("rows",10)("rowsPerPageOptions",F(9,H))("sortOrder",1))},dependencies:[G,W,J,N,R,A,$,O,P,L,K],encapsulation:2})};export{X as a};
