import{a as u,b as U,c as X}from"./chunk-JA7VJKBP.js";import"./chunk-U4EO7VLT.js";import{A as k,C as Y,E as q,I as z,K as J,_ as C,h as A,i as g,j as _,k as x,l as O,m as V,n as G,o as h,t as L,y as R}from"./chunk-7TWCM24X.js";import{Aa as y,Fa as P,M as F,Pa as w,Q as E,Qa as N,U as I,V as S,Va as s,Wa as c,Xa as d,Ya as m,db as M,fb as B,gb as f,qa as l,va as o,vd as T,zb as b}from"./chunk-NCFPMDGA.js";var a=class n{constructor(r){this.apiService=r}entityName;entityId;initialize(r){this.entityName=r.entityName,this.entityId=r.entityId}getEntities(){return new Promise((r,t)=>{try{this.apiService.getEntities(this.entityName).then(e=>{e&&r(e)},e=>{t(e)})}catch(e){console.log(e),t(e)}})}getEntityById(){return new Promise((r,t)=>{try{this.entityId>0?this.apiService.getEntityById(this.entityName,this.entityId).then(e=>{e&&r(e)},e=>{t(e)}):r({id:0})}catch(e){console.log(e),t(e)}})}createEntity(r){return new Promise((t,e)=>{try{this.apiService.createEntity(this.entityName,r).then(i=>{i&&t(i)},i=>{e(i)})}catch(i){console.log(i),e(i)}})}updateEntity(r){return new Promise((t,e)=>{try{this.apiService.updateEntity(this.entityName,this.entityId,r).then(i=>{i&&t(i)},i=>{e(i)})}catch(i){console.log(i),e(i)}})}deleteEntities(r){return new Promise((t,e)=>{try{this.apiService.deleteEntities(this.entityName,r).then(i=>{i&&t(i)},i=>{e(i)})}catch(i){console.log(i),e(i)}})}static \u0275fac=function(t){return new(t||n)(E(u))};static \u0275prov=F({token:n,factory:n.\u0275fac,providedIn:"root"})};var v=class n{constructor(r,t,e,i){this.crudManager=r;this.apiService=t;this.formBuilder=e;this.dialogService=i}entityName;entityId;selectedEntity;entities;selectedEntities=[];isForm=!1;isList=!1;entityForm;currentDate=new Date;ngOnInit(){}ngAfterViewInit(){}initList(){return new Promise((r,t)=>{try{this.crudManager.initialize(this),this.crudManager.getEntities().then(e=>{e&&(this.entities=e,r(e))},e=>{t(e)})}catch(e){console.log(e),t(e)}})}initForm(){return new Promise((r,t)=>{try{this.crudManager.initialize(this),this.loadResources().then(e=>{e&&this.crudManager.getEntityById().then(i=>{i&&(this.selectedEntity=i,this.entityForm=this.getForm(),r(i))},i=>{t(i)})},e=>{t(e)})}catch(e){console.log(e),t(e)}})}loadResources(){return Promise.all([])}canSave(){return this.entityForm?.valid??!1}getField(r){return this.entityForm.get(r)}getSpecialOptions(){return[]}prepareEntityToSave(){let r=this.entityForm.value;return r.id=this.selectedEntity.id,r}save(){return new Promise((r,t)=>{try{this.selectedEntity.id>0?this.crudManager.updateEntity(this.prepareEntityToSave()).then(e=>{e&&r(e)},e=>{t(e)}):this.crudManager.createEntity(this.prepareEntityToSave()).then(e=>{e&&r(e)},e=>{t(e)})}catch(e){console.log(e),t(e)}})}deleteEntities(){return new Promise((r,t)=>{try{this.crudManager.deleteEntities(this.selectedEntities.map(e=>e.id)).then(e=>{e&&(this.selectedEntities=[],this.crudManager.getEntities().then(i=>{i&&(this.entities=i,r(i))},i=>{t(i)}))},e=>{t(e)})}catch(e){console.log(e),t(e)}})}static \u0275fac=function(t){return new(t||n)(o(a),o(u),o(h),o(C))};static \u0275cmp=y({type:n,selectors:[["app-crud-base"]],standalone:!1,features:[b([a])],decls:0,vars:0,template:function(t,e){},encapsulation:2})};var D=class{single;plural;isFemale;constructor(r,t,e){this.single=r,this.plural=t,this.isFemale=e}};function ee(n,r){if(n&1){let t=M();c(0,"form",0)(1,"div",1)(2,"div",2),m(3,"app-label",3),c(4,"p-iconField"),m(5,"input",4)(6,"p-inputIcon",5),d()(),c(7,"div",2),m(8,"app-label",6)(9,"p-toggleButton",7),d(),c(10,"div",2),m(11,"app-label",8),c(12,"p-datePicker",9),B("onSelect",function(i){I(t);let p=f();return S(p.onChangeBirthday(i))})("onClear",function(i){I(t);let p=f();return S(p.onChangeBirthday(i))}),d()(),c(13,"div",2),m(14,"app-label",10)(15,"p-inputNumber",11),d(),c(16,"div",2),m(17,"app-label",12)(18,"p-select",13),d()()()}if(n&2){let t=f();s("formGroup",t.entityForm),l(3),s("abstractControl",t.getField("name")),l(5),s("abstractControl",t.getField("status")),l(3),s("abstractControl",t.getField("birthday")),l(3),s("abstractControl",t.getField("age")),l(),s("min",0)("disabled",!0),l(2),s("abstractControl",t.getField("class")),l(),s("options",t.classes)}}var W=class n extends v{constructor(t,e,i,p){super(t,e,i,p);this.crudManager=t;this.apiService=e;this.formBuilder=i;this.dialogService=p}classes;birthdayDialog;ngOnInit(){super.ngOnInit()}getDisplayColumns(){return[{field:"name",label:"Nome",displayColumnType:0},{field:"age",label:"Idade",displayColumnType:1},{field:"birthday",label:"Data Nasc.",displayColumnType:3},{field:"status",label:"Ativo",displayColumnType:2},{field:"class.name",label:"Classe",displayColumnType:4}]}getTypeDescription(){return new D("Membro","Membros",!1)}getForm(){let t=new Date(this.selectedEntity?.birthday);return t.toString()=="Invalid Date"&&(t=new Date),console.log(this.selectedEntity),this.formBuilder.group({name:[this.selectedEntity?.name??null,g.required],age:[this.selectedEntity?.age??0],birthday:[t],status:[this.selectedEntity?.status??!0,g.required],class:[this.selectedEntity?.class??null,g.required]})}loadResources(){return Promise.all([this.loadClasses()])}getSpecialOptions(){return[{buttonIcon:T.GIFT,buttonAction:()=>this.openBirthdayDialog()}]}onChangeBirthday(t){if(t==null){this.entityForm.get("age")?.setValue(0);return}let e=this.currentDate.getFullYear(),i=t.getFullYear(),p=e-i;this.entityForm.get("age")?.setValue(p)}loadClasses(){return new Promise((t,e)=>{try{this.apiService.getEntities("class").then(i=>{i&&(this.classes=i,t(i))},i=>{e(i)})}catch(i){console.log(i),e(i)}})}openBirthdayDialog(){this.birthdayDialog=this.dialogService.open(X,{data:{entities:this.entities},header:"Anivers\xE1rios",closable:!0,closeOnEscape:!1,draggable:!1,styleClass:"w-11 h-full overflow-visible"}),this.birthdayDialog?.onClose.subscribe(t=>{})}static \u0275fac=function(e){return new(e||n)(o(a),o(u),o(h),o(C))};static \u0275cmp=y({type:n,selectors:[["app-Member"]],standalone:!1,features:[b([a]),P],decls:1,vars:1,consts:[[3,"formGroup"],[1,"grid"],[1,"field","col-12","md:col-6"],["description","Nome",3,"abstractControl"],["type","text","pInputText","","id","name","formControlName","name","fluid","","placeholder","Digite o nome"],[1,"pi","pi-user"],["description","Status",3,"abstractControl"],["id","status","formControlName","status","onLabel","Ativo","offLabel","Inativo","fluid",""],["description","Data de nascimento",3,"abstractControl"],["id","birthday","inputId","birthday","formControlName","birthday","dateFormat","dd/mm/yy","fluid","","showIcon","true","showClear","true","placeholder","Selecione a data de nascimento",3,"onSelect","onClear"],["description","Idade",3,"abstractControl"],["id","age","inputId","age","formControlName","age","fluid","","showButtons","true","showClear","false","placeholder","Digite a idade",3,"min","disabled"],["description","Classe",3,"abstractControl"],["optionLabel","name","formControlName","class","fluid","",3,"options"]],template:function(e,i){e&1&&w(0,ee,19,9,"form",0),e&2&&N(i.isForm&&i.selectedEntity?0:-1)},dependencies:[O,A,_,x,G,V,L,k,J,q,Y,z,R,U],encapsulation:2})};export{W as MemberComponent};
